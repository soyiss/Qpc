<!DOCTYPE html>

<th:block th:fragment="adminNav">


  <!-- ìŠ¤ìœ„íŠ¸ ì–¼ëŸ¿ cdnì¶”ê°€  -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.css">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

  <style>
    body {
      background-color: #4b5359;
    }

    #nav {
      text-align: center;
      margin: 0 auto;
    }

    ul {
      display: inline-block;
      list-style: none;
      margin-top: 10px;
      padding: 0;
    }

    li {
      display: inline-block;
      margin-right: 15px;
    }

    li:last-child {
      margin-right: 0;
    }

    a {
      display: block;
      text-decoration: none;
    }

    .modal-content {
      display: flex;
      justify-content: space-between;
      align-items: center;

    }

    .modal-body {
      flex-grow: 1;
      text-align: left;
    }

    .modal-close {

      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
    }


  </style>

  <div id="nav">
    <ul>
      <li style="background-color: white; ">
        <a href="/" style="color: #4872bb">ğŸ•¹ <img src="/img/Q_PC_Room_Logo.png" style="width: 80px; height: 24px"> ğŸ®</a>
      </li>
      <li>
        <a onclick="blackList()">íšŒì›ê´€ë¦¬</a>
      </li>
      <li>
        <a>ìƒí’ˆê´€ë¦¬</a>
      </li>
      <li>
        <a>ê²Œì„ê´€ë¦¬</a>
      </li>
      <li>
        <a onclick="category()">ì¹´í…Œê³ ë¦¬ ê´€ë¦¬</a>
      </li>
      <li>
        <a>ì±„íŒ…</a>
      </li>
    </ul>
  </div>

  <!-- íšŒì›ê´€ë¦¬ ëª¨ë‹¬ ì°½ -->
  <div id="memberModal" class="modal">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <span class="modal-close" onclick="closeModal('memberModal')">&times;</span>
        <h3>íšŒì›ê´€ë¦¬</h3>
        <!-- ëª¨ë‹¬ ë‚´ìš© -->
      </div>
    </div>
  </div>

  <!-- ìƒí’ˆê´€ë¦¬ ëª¨ë‹¬ ì°½ -->
  <div id="productModal" class="modal">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <span class="modal-close" onclick="closeModal('productModal')">&times;</span>
        <h3>ìƒí’ˆê´€ë¦¬</h3>
        <!-- ëª¨ë‹¬ ë‚´ìš© -->
        <div id="product-section">
          <table>
            <tr>
              <th>id</th>
              <th>ìƒí’ˆ ì´ë¦„</th>
              <th>ìƒí’ˆ ê°€ê²©</th>
              <th>ìƒí’ˆ ê°œìˆ˜</th>
            </tr>
            <th:each items="${productList}" var="product">
              <tr>
                <td>${product.id}</td>
                <td>${product.productName}</td>
                <td>${product.productPrice}</td>
                <td>${product.productCount}</td>
                <td>
                  <button onclick="openModal('productUpdateModal')">ì¡°íšŒ</button>
                </td>

                <td>
                  <button onclick="productDelete()">ì‚­ì œ</button>
                </td>
              </tr>
            </th:each>
          </table>
        </div> <br>
        <button onclick="openModal('productSaveModal')" style="text-align: left;">ìƒí’ˆ ë“±ë¡</button> <br>

      </div>
    </div>
  </div>

  <!-- ìƒí’ˆ ë“±ë¡ ëª¨ë‹¬ ì°½ -->
  <div id="productSaveModal" class="modal"  style="margin: 0 auto;padding: 20px;">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content" style="margin: 0 auto; width: 80%">
        <span class="modal-close" onclick="closeModal('productSaveModal')">&times;</span>
        <h3>ìƒí’ˆ ë“±ë¡</h3>
        <!-- ëª¨ë‹¬ ë‚´ìš© -->
        <form action="/product/save" method="post" id="productSaveForm" enctype="multipart/form-data">
          <select name="productCategory" id="product-save-category" class="form-control">
            <option value="">ì„ íƒí•´ì£¼ì„¸ìš”</option>
            <option value="">ì‹ì‚¬ë¥˜</option>
            <option value="">íŠ€ê¹€</option>
            <option value="">ê°„ì‹</option>
            <option value="">ìŒë£Œ</option>
            <option value="">ì„¸íŠ¸ë©”ë‰´</option>
          </select> <br>
          <input type="text" placeholder="ìƒí’ˆì´ë¦„" class="form-control"> <br>
          <input type="text" placeholder="ìƒí’ˆê°€ê²©" class="form-control"> <br>
          <input type="text" placeholder="ìƒí’ˆê°œìˆ˜" class="form-control"> <br>

          <input type="file" name="productFile" class="form-control"> <br>
          <button style="margin: 0 auto;">ìƒí’ˆë“±ë¡</button>
        </form> <br>
      </div>
    </div>
  </div>


  <!-- ìƒí’ˆ ì¡°íšŒ-ìˆ˜ì • ëª¨ë‹¬ ì°½ -->
  <div id="productUpdateModal" class="modal" style="margin: 0 auto;padding: 20px;">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content" style="margin: 0 auto; width: 80%">
        <span class="modal-close" onclick="closeModal('productUpdateModal')">&times;</span>
        <button onclick="closeModal('productUpdateModal')">ìƒí’ˆëª©ë¡</button>
        <h3>ìƒí’ˆ ì¡°íšŒ</h3>
        <!-- ëª¨ë‹¬ ë‚´ìš© -->

        <!--        <tr th:if="${product.fileAttached == 1}">-->
        <th>ìƒí’ˆì´ë¯¸ì§€</th>
        <!--          <td th:each="fileName: ${product.storedFileName}">-->
        <img th:src="@{|/upload/${fileName}}" alt="">
        </td>
        </tr>

        <form action="/product/update" method="post" id="productUpdateForm" enctype="multipart/form-data">
          <select name="productCategory" id="product-update-category" class="form-control">
            <option value="">ì„ íƒí•´ì£¼ì„¸ìš”</option>
            <option value="">ì‹ì‚¬ë¥˜</option>
            <option value="">íŠ€ê¹€</option>
            <option value="">ê°„ì‹</option>
            <option value="">ìŒë£Œ</option>
            <option value="">ì„¸íŠ¸ë©”ë‰´</option>
          </select> <br>
          <input type="text" placeholder="ìƒí’ˆì´ë¦„" class="form-control"> <br>
          <input type="text" placeholder="ìƒí’ˆê°€ê²©" class="form-control"> <br>
          <input type="text" placeholder="ìƒí’ˆê°œìˆ˜" class="form-control"> <br>
          <input type="file" name="productFile" class="form-control"> <br>
          <input type="submit" style="margin: 0 auto;" value="ìƒí’ˆìˆ˜ì •">
        </form> <br>
      </div>
    </div>
  </div>



  <!-- ê²Œì„ê´€ë¦¬ ëª¨ë‹¬ ì°½ -->
  <div id="gameModal" class="modal">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content" style="margin: 0 auto;">
        <span class="modal-close" onclick="closeModal('gameModal')">&times;</span>
        <h3>ê²Œì„ê´€ë¦¬</h3>
        <!-- ëª¨ë‹¬ ë‚´ìš© -->
        <div id="game-section">
          <table>
            <tr>
              <th>id</th>
              <th>ê²Œì„ ì´ë¯¸ì§€</th>
              <th>ê²Œì„ ì´ë¦„</th>
            </tr>
            <th:each items="${gameList}" var="game">
              <tr>
                <td>${game.id}</td>
                <td>${game.gameImg}</td>
                <td>${game.gameName}</td>
                <td>
                  <button class="btn btn-primary" onclick="openModal('gameUpdateModal')">ìˆ˜ì •</button>
                </td>
                <td>
                  <button class="btn btn-danger" onclick="gameDelete()">ì‚­ì œ</button>
                </td>
              </tr>
            </th:each>
          </table>
        </div> <br>
        <button class="btn btn-primary" onclick="openModal('gameSaveModal')" style="text-align: left;">ê²Œì„ ë“±ë¡</button> <br>
      </div>
    </div>
  </div>

  <!-- ê²Œì„ ë“±ë¡ ëª¨ë‹¬ ì°½ -->
  <div id="gameSaveModal" class="modal"  style="margin: 0 auto;padding: 20px;">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content" style="margin: 0 auto; width: 80%">
        <span class="modal-close" onclick="closeModal('gameSaveModal')">&times;</span>
        <h3>ê²Œì„ ë“±ë¡</h3>
        <!-- ëª¨ë‹¬ ë‚´ìš© -->
        <form action="/game/save" method="post" id="gameSaveForm" onsubmit="return gameSaveCheck()" enctype="multipart/form-data">
          <th:block th:if="${#lists.isEmpty(gameCategoryList)}">
            <p>ì¹´í…Œê³ ë¦¬ê°€ ì•„ì§ ë“±ë¡ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</p>
          </th:block>
          <th:block th:unless="${#lists.isEmpty(gameCategoryList)}">
            <select name="gameCategoryName" id="game-save-category" class="form-control mb-3">
              <option th:each="category : ${gameCategoryList}" th:value="${category.gameCategoryName}" th:text="${category.gameCategoryName}"></option>
            </select>
            <input type="text" name="gameName" placeholder="ê²Œì„ì´ë¦„" class="form-control mb-3">
            <input type="text" name="gameLink" placeholder="ê²Œì„ë§í¬" class="form-control mb-3">
            <input type="file" name="gameFile" class="form-control">
          <button class="btn btn-primary" style="text-align: center; align-items: center">ê²Œì„ë“±ë¡</button>
          </th:block>
        </form>
      </div>
    </div>
  </div>

  <!-- ê²Œì„ ìˆ˜ì • ëª¨ë‹¬ ì°½ -->
  <div id="gameUpdateModal" class="modal" style="margin: 0 auto;padding: 20px;">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content" style="margin: 0 auto; width: 80%">
        <span class="modal-close" onclick="closeModal('gameUpdateModal')">&times;</span>
        <h3>ê²Œì„ ìˆ˜ì •</h3>
        <!-- ëª¨ë‹¬ ë‚´ìš© -->
        <!--        <tr th:if="${game.fileAttached == 1}">-->
        <th>ê²Œì„ì´ë¯¸ì§€</th>
        <!--          <td th:each="fileName: ${game.storedFileName}">-->
        <img th:src="@{|/upload/${fileName}}" alt="">
        </td>
        </tr>

        <form action="/game/update" method="post" id="gameUpdateForm" enctype="multipart/form-data">
          <select name="gameCategoryName" id="game-update-category" class="form-control">
            <option th:each="category : ${gameCategoryList}" th:value="${category.id}" th:text="${category.gameCategoryName}"></option>
          </select>
          <input type="text" name="gameName" placeholder="ê²Œì„ì´ë¦„" class="form-control">
          <input type="text" name="gameLink" placeholder="ê²Œì„ë§í¬" class="form-control">
          <input type="file" name="gameFile" class="form-control">
          <input type="submit" style="margin: 0 auto;" value="ê²Œì„ìˆ˜ì •">
        </form>
      </div>
    </div>
  </div>

  <!--  &lt;!&ndash; ì¹´í…Œê³ ë¦¬ ë“±ë¡ ëª¨ë‹¬ ì°½ &ndash;&gt;-->
  <!--  <div id="categoryModal" class="modal">-->
  <!--    <div class="modal-dialog modal-dialog-centered">-->
  <!--    <div class="modal-content">-->
  <!--      <span class="modal-close" onclick="closeModal('categoryModal')">&times;</span>-->
  <!--      <h3>ì¹´í…Œê³ ë¦¬ ê´€ë¦¬</h3>-->
  <!--      &lt;!&ndash; ëª¨ë‹¬ ë‚´ìš© &ndash;&gt;-->
  <!--      <p>ëª¨ë‹¬ ë‚´ìš©ì„ ì¶”ê°€í•˜ì„¸ìš”.</p>-->
  <!--    </div>-->
  <!--  </div>-->
  <!--  </div>-->

  <!-- ì±„íŒ… ëª¨ë‹¬ ì°½ -->
  <div id="chatModal" class="modal">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <span class="modal-close" onclick="closeModal('chatModal')">&times;</span>
        <h3>ì±„íŒ…</h3>
        <!-- ëª¨ë‹¬ ë‚´ìš© -->
        <p>ëª¨ë‹¬ ë‚´ìš©ì„ ì¶”ê°€í•˜ì„¸ìš”.</p>
      </div>
    </div>
  </div>






  <script>
    // ëª¨ë‹¬ ì—´ê¸°
    function openModal(modalId) {
      var modal = document.getElementById(modalId);
      modal.classList.add('show');
    }

    // ëª¨ë‹¬ ë‹«ê¸°
    function closeModal(modalId) {
      var modal = document.getElementById(modalId);
      modal.classList.remove('show');
    }

    // ë§í¬ í´ë¦­ ì‹œ ëª¨ë‹¬ ì—´ê¸°
    var links = document.querySelectorAll("#nav li a");
    links.forEach(function(link) {
      link.addEventListener("click", function(event) {
        event.preventDefault();
        var modalId = this.textContent.toLowerCase() + "Modal";
        openModal(modalId);
      });
    });

    // ê° ëª¨ë‹¬ì˜ ë‹«ê¸° ë²„íŠ¼ ì´ë²¤íŠ¸ ì²˜ë¦¬
    var closeButtons = document.querySelectorAll(".modal-close");
    closeButtons.forEach(function(button) {
      button.addEventListener("click", function(event) {
        event.preventDefault();
        var modalId = this.parentNode.parentNode.getAttribute("id");
        closeModal(modalId);
      });
    });

    // ê° ë§í¬ í´ë¦­ ì‹œ ëª¨ë‹¬ ì—´ê¸°
    var memberLink = document.querySelector("#nav li:nth-child(2) a");
    memberLink.addEventListener("click", function() {
      openModal("memberModal");
    });

    var productLink = document.querySelector("#nav li:nth-child(3) a");
    productLink.addEventListener("click", function() {
      openModal("productModal");
    });

    var gameLink = document.querySelector("#nav li:nth-child(4) a");
    gameLink.addEventListener("click", function() {
      openModal("gameModal");
    });

    // ì¹´í…Œê³ ë¦¬ ëª¨ë‹¬ ì‚¬ìš© ì•ˆí•¨(ë°”ë€”ìˆ˜ë„,,)
    // var categoryLink = document.querySelector("#nav li:nth-child(5) a");
    // categoryLink.addEventListener("click", function() {
    //   openModal("categoryModal");
    // });

    var chatLink = document.querySelector("#nav li:nth-child(6) a");
    chatLink.addEventListener("click", function() {
      openModal("chatModal");
    });

    function openLink(url) {
      window.location.href = url; // í•´ë‹¹ ì£¼ì†Œë¡œ ì´ë™í•©ë‹ˆë‹¤.
    }

    function category() {
      Swal.fire({
        title: "ì¹´í…Œê³ ë¦¬",
        text: "ì¹´í…Œê³ ë¦¬ ê´€ë¦¬ ì°½ì…ë‹ˆë‹¤.",
        showCancelButton: true,
        confirmButtonText: "ê²Œì„",
        cancelButtonText: "ìƒí’ˆ",
        allowOutsideClick: false, // alertì°½ ë°–ì„ ëˆŒëŸ¬ë„ í™”ë©´ê³ ì •
        allowEscapeKey: true // ESC í‚¤ë¥¼ ëˆ„ë¥´ë©´ êº¼ì§
      }).then((result) => {
        if (result.dismiss === Swal.DismissReason.esc) {
          return; // ESC í‚¤ë¥¼ í´ë¦­ ì‹œ ì¢…ë£Œ
        }

        if (result.isConfirmed) {
          openLink("/GameCategory/game");
        } else {
          openLink("/category/product");
        }
      });
    }

    function gameDelete() {
      Swal.fire({
        title: "ê²Œì„ ì‚­ì œ",
        text: "ê²Œì„ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
        icon: "question",
        showCancelButton: true,
        confirmButtonText: "ì˜ˆ",
        cancelButtonText: "ì•„ë‹ˆì˜¤"
      }).then((result) => {
        if (result.isConfirmed) {
          // ì‚­ì œ ì‘ì—… ìˆ˜í–‰
          // ì—¬ê¸°ì— ì‚­ì œ ë¡œì§ì„ ì¶”ê°€í•˜ì„¸ìš”.
          Swal.fire("ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.", "", "success");
        }
      });
    }

    function productDelete() {
      Swal.fire({
        title: "ìƒí’ˆ ì‚­ì œ",
        text: "ìƒí’ˆì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
        icon: "question",
        showCancelButton: true,
        confirmButtonText: "ì˜ˆ",
        cancelButtonText: "ì•„ë‹ˆì˜¤"
      }).then((result) => {
        if (result.isConfirmed) {
          // ì‚­ì œ ì‘ì—… ìˆ˜í–‰
          // ì—¬ê¸°ì— ì‚­ì œ ë¡œì§ì„ ì¶”ê°€í•˜ì„¸ìš”.
          Swal.fire("ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.", "", "success");
        }
      });
    }


    const blackList = () => {
      location.href="/admin/memberList"
    }

    const gameSaveCheck = () => {
      const gameName = document.querySelector('input[name="gameName"]').value;
      const gameLink = document.querySelector('input[name="gameLink"]').value;

      if(gameName.length===0) {
        alert("ê²Œì„ ì´ë¦„ì„ ì‘ì„±í•´ì£¼ì„¸ìš”!");
        return false;
      }else if(gameLink.length===0) {
        alert("ê²Œì„ ë§í¬ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”!");
        return false;
      }else {
        alert("ê²Œì„ ë“±ë¡ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.")
        return true;
      }
    }

  </script>
</th:block>
</html>